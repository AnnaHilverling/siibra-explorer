<div *ngIf = "meetsRequirement" class = "atlas-container" helpdirective>

  <ui-nehuba-container (contextmenu)="nehubaClickHandler($event)">
  </ui-nehuba-container>

  <div bannerWrapper>
    <menu-icons iconWrapper>
    </menu-icons>
    <signin-banner signinWrapper>
    </signin-banner>
  </div>

  <layout-floating-container
    zIndex = "9"
    #floatingOverlayContainer>
    <div floatingContainerDirective>

    </div>
    
    <panel-component class="shadow" fixedMouseContextualContainerDirective #rClContextMenu>
      <div heading>
        <h5 class="pe-all p-2 m-0">
          What's here?
        </h5>
      </div>
      <div body>
        <div
          *ngIf="onhoverSegmentForFixed$ | async; let onhoverSegmentFixed"
          (click)="searchRegion([onhoverSegmentFixed])"
          class="ws-no-wrap text-left pe-all btn btn-sm btn-secondary btn-block"
          data-toggle="tooltip" 
          data-placement="top" 
          [title]="onhoverSegmentFixed.name">
          Search KG for {{ onhoverSegmentFixed.name }}
        </div>

        <div
          *ngIf="selectedRegions$ | async; let selectedRegions"
          (click)="searchRegion(selectedRegions)"
          class="ws-no-wrap text-left pe-all mt-0 btn btn-sm btn-secondary btn-block">
          Search KG for {{ selectedRegions && selectedRegions.length }} selected regions
        </div>

        <ng-template #noRegionSelected>
          <div
            (click)="searchRegion()"
            class="ws-no-wrap text-left pe-all mt-0 btn btn-sm btn-secondary btn-block">
            No region selected. Search KG for all datasets in this template space.
          </div>
        </ng-template>

      </div>
    </panel-component>
    
    <div floatingMouseContextualContainer floatingMouseContextualContainerDirective>
      <div 
        *ngIf="onhoverLandmark$ | async" 
        contextualBlock>
        {{ onhoverLandmark$ | async }} <i><small class = "mute-text">{{ toggleMessage }}</small></i>
      </div>
      <div 
        *ngIf="onhoverSegment$ | async; let onhoverSegment" 
        contextualBlock>
        {{ onhoverSegment.name }} <i><small class = "mute-text">{{ toggleMessage }}</small></i>
      </div>
      <!-- TODO Potentially implementing plugin contextual info -->
    </div>

    <div toastContainer>
      <div toastDirective>
      </div>
    </div>
  </layout-floating-container>

  <div pluginFactoryDirective>
  </div>

</div>

<ng-template #helpComponent>
  <help-component>
  </help-component>
</ng-template>
<ng-template #viewerConfigComponent>
  <config-component>
  </config-component>
</ng-template>
<ng-template #signinModalComponent>
  <signin-modal>
    
  </signin-modal>
</ng-template>
<ng-template #cookieAgreementComponent>
  <cookie-agreement>
  </cookie-agreement>

  <div class="modal-footer">
    <button type="button" class="btn btn-primary" (click)="cookieClickedOk()">Ok</button>
  </div>
</ng-template>

<div class="d-flex flex-column" minReq *ngIf="!meetsRequirement">
  <div class="jumbotron bg-light text-center mb-0">
    <div>
      <h1 class="mb-3">
        <i class="fas fa-exclamation-triangle"></i> Unsupported browser detected
      </h1>
      <p>
        We recommend using the latest version of <a target="_blank" href="https://www.google.com/chrome/">Google Chrome</a> or <a target="_blank" href="https://www.mozilla.org/firefox/">Mozilla Firefox</a> for viewing the interactive viewer.
      </p>
      <div class="col-6 d-inline-block text-left">
        <readmore-component
          [collapsedHeight]="0">
          <markdown-dom [markdown]="constantsService.minReqExplaner">

          </markdown-dom>
        </readmore-component>
      </div>
      
    </div>
  </div>
  <ng-container *ngFor="let preview of unsupportedPreviews; let idx = index">
    <div [hidden]="idx !== unsupportedPreviewIdx" class="text-center mb-3" imageContainer [style.backgroundImage]="'url(' + preview.previewSrc + ')'" >
      <div class="mt-2 card d-inline-block displayCard">
        <div class="card-body">
          {{ preview.text }}
        </div>
      </div>
    </div>
  </ng-container>

</div>
