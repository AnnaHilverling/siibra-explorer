
<!-- title -->
<mat-card-subtitle>
  {{ name }}
</mat-card-subtitle>

<mat-card-content mat-dialog-content>

  <!-- description -->
  <small>
    <markdown-dom class="d-block" [markdown]="description">

    </markdown-dom>
  </small>

  <!-- publications -->
  <small class="d-block mb-2"
    *ngFor="let publication of publications">
    <a *ngIf="publication.doi; else plainText"
      iav-stop="click mousedown"
      [href]="publication.doi | doiParserPipe"
      target="_blank">
      {{ publication.cite }}
    </a>
    <ng-template #plainText>
      {{ publication.cite }}
    </ng-template>
  </small>
</mat-card-content>


<!-- footer -->
<mat-card-actions>

  <!-- explore -->
  <a *ngFor="let kgRef of kgReference"
    class="m-2"
    [href]="kgRef | doiParserPipe"
    target="_blank">
    <button 
      mat-raised-button
      color="primary">
      Explore
      <i class="fas fa-external-link-alt"></i>
    </button>
  </a>

  <!-- pin data -->
  <button mat-button
    *ngIf="downloadEnabled"
    iav-stop="click mousedown"
    (click)="toggleFav()"
    color="primary"
    [color]="(favedDataentries$ | async | datasetIsFaved : dataset) ? 'primary' : 'basic'">
    {{ (favedDataentries$ | async | datasetIsFaved : dataset) ? 'Unpin' : 'Pin' }} this dataset
    <i class="fas fa-thumbtack"></i>
  </button>


  <!-- download -->
  <a *ngIf="files && files.length > 0"
    [href]="dlFromKgHref"
    target="_blank">
    <button
      [disabled]="downloadInProgress"
      [matTooltip]="tooltipText"
      class="m-2"
      mat-button
      color="basic">
      <span>
        Download as Zip
      </span>
      <i class="ml-1 fas" [ngClass]="!downloadInProgress? 'fa-download' :'fa-spinner fa-pulse'"></i>
    </button>
  </a>


  <!-- check if has preview -->
  <kg-dataset-list
    class="d-none"
    [backendUrl]="DS_PREVIEW_URL"
    *ngIf="kgId"
    (kgDsPrvUpdated)="handleKgDsPrvUpdate($event)"
    [kgId]="kgId">

  </kg-dataset-list>

  <button mat-button
    mat-dialog-close
    *ngIf="hasPreview"
    (click)="showPreviewList(previewFilesListTemplate)"
    color="basic">
    <span>
      Preview
    </span>
    <i class="ml-1 far fa-eye"></i>
  </button>

</mat-card-actions>

<mat-card-footer></mat-card-footer>

<ng-template #previewFilesListTemplate>
  <dataset-preview-list
    [kgId]="kgId"
    (previewingFile)="handlePreviewFile($event)">

  </dataset-preview-list>
</ng-template>
