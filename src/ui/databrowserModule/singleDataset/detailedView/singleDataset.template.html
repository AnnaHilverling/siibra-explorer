<mat-card mat-ripple [matRippleDisabled]="!ripple">
  
  <!-- title -->
  <mat-card-header *ngIf="!simpleMode">
    <mat-card-title>
      {{ name }}
    </mat-card-title>
  </mat-card-header>

  <mat-card-content *ngIf="simpleMode">
    <p>
      {{ name }}
    </p>
    <mat-grid-list [cols]="kgReference.length + (preview ? 1 : 0) + (downloadEnabled ? 2 : 0)" rowHeight="4em">

      <!-- explore -->
      <mat-grid-tile *ngFor="let kgRef of kgReference">
        <a [href]="kgRef | doiParserPipe"
          matTooltip="Explore"
          iav-stop="click mousedown"
          mat-icon-button
          target="_blank">
          <i class="fas fa-external-link-alt"></i>
        </a>
      </mat-grid-tile>

      <!-- pin -->
      <mat-grid-tile *ngIf="downloadEnabled">

        <button
          iav-stop="click mousedown"
          (click)="toggleFav()"
          matTooltip="Pin"
          mat-icon-button
          [color]="(favedDataentries$ | async | datasetIsFaved : dataset) ? 'primary' : 'basic'">
          <i class="fas fa-thumbtack"></i>
        </button>
      </mat-grid-tile>

      <!-- preview -->
      <mat-grid-tile *ngIf="preview">
        <button
          iav-stop="click mousedown"
          (click)="showPreviewList(previewFilesListTemplate)"
          matTooltip="Preview"
          mat-icon-button>
          <i class="far fa-eye"></i>
        </button>
      </mat-grid-tile>

      <!-- download -->
      <mat-grid-tile *ngIf="downloadEnabled">
        <button
          matTooltip="Download"
          iav-stop="click mousedown"
          (click)="downloadZipFromKg()"
          [disabled]="downloadInProgress"
          mat-icon-button>
          <i class="ml-1 fas" [ngClass]="!downloadInProgress? 'fa-download' :'fa-spinner fa-pulse'"></i>
        </button>
      </mat-grid-tile>
    </mat-grid-list>
  </mat-card-content>
  
  <!-- description -->
  <mat-card-content *ngIf="!simpleMode">
    <p>{{ description }}</p>
  </mat-card-content>

  <!-- publications -->
  <mat-card-content *ngIf="!simpleMode">
    <div class="d-block mb-2"
      *ngFor="let publication of publications">
      <a *ngIf="publication.doi; else plainText"
        iav-stop="click mousedown"
        [href]="publication.doi | doiParserPipe"
        target="_blank">
        {{ publication.cite }}
      </a>
      <ng-template #plainText>
        {{ publication.cite }}
      </ng-template>
    </div>
  </mat-card-content>


  <!-- footer -->
  <mat-card-actions *ngIf="!simpleMode">

    <!-- explore -->
    <a *ngFor="let kgRef of kgReference"
      class="m-2"
      [href]="kgRef | doiParserPipe"
      target="_blank">
      <button 
        mat-raised-button
        color="primary">
        Explore
        <i class="fas fa-external-link-alt"></i>
      </button>
    </a>

    <!-- pin data -->
    <button mat-button
      iav-stop="click mousedown"
      (click)="toggleFav()"
      color="primary"
      [color]="(favedDataentries$ | async | datasetIsFaved : dataset) ? 'primary' : 'basic'">
      {{ (favedDataentries$ | async | datasetIsFaved : dataset) ? 'Unpin' : 'Pin' }} this dataset
      <i class="fas fa-thumbtack"></i>
    </button>


    <!-- download -->
    <button
      (click)="downloadZipFromKg()"
      [disabled]="downloadInProgress"
      [matTooltip]="tooltipText"
      class="m-2"
      *ngIf="files.length > 0"
      mat-button
      color="primary">
      <span>
        Download as Zip
      </span>
      <i class="ml-1 fas" [ngClass]="!downloadInProgress? 'fa-download' :'fa-spinner fa-pulse'"></i>
    </button>
  </mat-card-actions>

  <mat-card-footer></mat-card-footer>
</mat-card>

<ng-template #previewFilesListTemplate>
  <preview-component
    (previewFile)="handlePreviewFile($event)"
    [datasetName]="name">
  </preview-component>
</ng-template>