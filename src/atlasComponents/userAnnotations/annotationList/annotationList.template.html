<!-- header -->

<div class="d-flex">
    <h2 class="mat-h2 mt-4 text-muted">
        Annotations
    </h2>
</div>

<mat-divider></mat-divider>


<!-- list of annotations -->
<ng-template [ngIf]="managedAnnotations$ | async" [ngIfElse]="placeholderTmpl" let-managedAnnotations>

    <mat-accordion *ngIf="managedAnnotations.length > 0; else placeholderTmpl"
        [attr.aria-label]="ARIA_LABELS.USER_ANNOTATION_LIST"
        class="h-100 d-flex flex-column overflow-auto">

        <!-- expansion panel -->
        <mat-expansion-panel *ngFor="let managedAnnotation of managedAnnotations"
            hideToggle>

            <mat-expansion-panel-header [ngClass]="{'highlight': managedAnnotation.highlighted }">
                <mat-panel-title class="d-flex align-items-center">

                    <!-- toggle visibility -->
                    <button
                        mat-icon-button
                        iav-stop="click"
                        (click)="toggleManagedAnnotationVisibility(managedAnnotation.id)">
                        <i [ngClass]="(hiddenAnnotations$ | async | annotationVisiblePipe : managedAnnotation) ?  'fa-eye' : 'fa-eye-slash'" class="fas"></i>
                    </button>
                    <span class="flex-shrink-1 flex-grow-1" [ngClass]="{ 'text-muted': !managedAnnotation.name }">
                        {{ managedAnnotation | singleAnnotationNamePipe : managedAnnotation.name }}
                    </span>    
                    <i class="flex-shrink-0 flex-grow-0" [ngClass]="managedAnnotation | singleannotationClsIconPipe"></i>
                </mat-panel-title>
            </mat-expansion-panel-header>

            <!-- single annotation edit body -->
            <ng-template matExpansionPanelContent>
                <single-annotation-unit
                    [single-annotation-unit-annotation]="managedAnnotation">
                </single-annotation-unit>
            </ng-template>
        </mat-expansion-panel>
    </mat-accordion>
</ng-template>

<!-- place holder when no annotations exist -->
<ng-template #placeholderTmpl>
    <mat-card>
        <span>
            No annotations visible yet. 
        </span>
        <span>
            Start by adding an annotion, or import an existing annotation.
        </span>
    </mat-card>
</ng-template>